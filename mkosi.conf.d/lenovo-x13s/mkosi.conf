[Match]
Architecture=arm64

[Content]
Devicetrees=
    qcom/sc8280xp-lenovo-thinkpad-x13s.dtb
KernelCommandLine=
# tpm is not supported on lenovo-x13s
        rd.systemd.mask=dev-tpm0.device
        systemd.mask=dev-tpm0.service
        rd.systemd.mask=dev-tpmrm0.device
        systemd.mask=dev-tpmrm0.device
        rd.systemd.mask=tpm2.target
        systemd.mask=tpm2.target
        systemd.mask=systemd-pcrlock-firmware-code.service
        systemd.mask=systemd-pcrlock-firmware-config.service
        systemd.mask=systemd-pcrlock-make-policy.service
# support for this platform is not perfect, disable what we *know* does not work
        arm64.nopauth clk_ignore_unused pd_ignore_unused
Packages=
# firmware for lenovo-x31s
        firmware-qcom-soc
        firmware-atheros
# add basic qualcomm tools
        protection-domain-mapper
        qrtr-tools
# not sure why this is needed
        acpi
# make sound work
        alsa-topology-conf
        alsa-ucm-conf
FirmwareFiles=
        qcom/sc8280xp/LENOVO/21BX/qcadsp8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qccdsp8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qcdxkmsuc8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qcslpi8280.mbn
        qcom/a660_sqe.fw
        qcom/a660_gmu.bin
KernelInitrdModules=
# Ensure that modules needed for boot are present
        /drivers/nvme/host/nvme
        /drivers/phy/qualcomm/phy-qcom-qmp-pcie
# Ensure that modules needed for display output are present
        /drivers/clk/qcom/gpucc-sc8280xp
        /drivers/gpu/drm/display/drm_display_helper
        /drivers/gpu/drm/display/drm_dp_aux_bus
        /drivers/gpu/drm/drm
        /drivers/gpu/drm/drm_exec
        /drivers/gpu/drm/drm_kms_helper
        /drivers/gpu/drm/panel/panel-edp
        /drivers/hid/i2c-hid/i2c-hid
        /drivers/hid/i2c-hid/i2c-hid-of
        /drivers/i2c/busses/i2c-qcom-geni
        /drivers/leds/rgb/leds-qcom-lpg
        /drivers/phy/qualcomm/phy-qcom-edp
        /drivers/phy/qualcomm/phy-qcom-qmp-combo
        /drivers/soc/qcom/pmic_glink_altmode
        /net/qrtr/qrtr
# llm generated list here
        /arch/arm64/crypto/aes-ce-blk
        /arch/arm64/crypto/aes-ce-ccm
        /arch/arm64/crypto/aes-ce-cipher
        /arch/arm64/crypto/aes-neon-blk
        /arch/arm64/crypto/aes-neon-bs
        /arch/arm64/lib/xor-neon
        /crypto/algif_hash
        /crypto/algif_skcipher
        /crypto/crc32c-cryptoapi
        /crypto/ecdh_generic
        /crypto/hkdf
        /crypto/michael_mic
        /crypto/xor
        /drivers/base/regmap/regmap-sdw
        /drivers/block/loop
        /drivers/block/zram/zram
        /drivers/bus/mhi/host/mhi
        /drivers/bus/mhi/host/mhi_pci_generic
        /drivers/clk/qcom/camcc-sc8280xp
        /drivers/clk/qcom/lpasscc-sc8280xp
        /drivers/cpufreq/cpufreq_conservative
        /drivers/cpufreq/qcom-cpufreq-hw
        /drivers/crypto/qcom-rng
        /drivers/dma/qcom/gpi
        /drivers/edac/qcom_edac
        /drivers/firmware/efi/efi-pstore
        /drivers/gpu/drm/bridge/aux-hpd-bridge
        /drivers/gpu/drm/clients/drm_client_lib
        /drivers/gpu/drm/drm_gpuvm
        /drivers/gpu/drm/scheduler/gpu-sched
        /drivers/hid/hid
        /drivers/hid/i2c-hid/i2c-hid-of-elan
        /drivers/hwspinlock/qcom_hwspinlock
        /drivers/i2c/busses/i2c-qcom-cci
        /drivers/i2c/i2c-dev
        /drivers/iio/adc/qcom-spmi-adc5
        /drivers/iio/adc/qcom-vadc-common
        /drivers/input/evdev
        /drivers/input/joydev
        /drivers/input/keyboard/gpio_keys
        /drivers/input/misc/pm8941-pwrkey
        /drivers/interconnect/qcom/icc-osm-l3
        /drivers/interconnect/qcom/qnoc-sc8280xp
        /drivers/leds/led-class-multicolor
        /drivers/leds/leds-gpio
        /drivers/mailbox/qcom-ipcc
        /drivers/md/dm-bufio
        /drivers/md/dm-crypt
        /drivers/md/dm-mod
        /drivers/md/dm-verity
        /drivers/mfd/qcom-pm8008
        /drivers/mfd/qcom-spmi-pmic
        /drivers/misc/fastrpc
        /drivers/net/tun
        /drivers/nvme/common/nvme-auth
        /drivers/nvme/common/nvme-keyring
        /drivers/nvme/host/nvme-core
        /drivers/nvme/host/nvme-fabrics
        /drivers/nvmem/nvmem_qfprom
        /drivers/pci/pwrctrl/pci-pwrctrl-pwrseq
        /drivers/phy/qualcomm/phy-qcom-qmp-usb
        /drivers/phy/qualcomm/phy-qcom-snps-femto-v2
        /drivers/pinctrl/qcom/pinctrl-lpass-lpi
        /drivers/pinctrl/qcom/pinctrl-sc8280xp-lpass-lpi
        /drivers/power/reset/qcom-pon
        /drivers/power/reset/reboot-mode
        /drivers/power/sequencing/pwrseq-core
        /drivers/power/sequencing/pwrseq-qcom-wcn
        /drivers/power/supply/qcom_battmgr
        /drivers/regulator/fixed
        /drivers/regulator/qcom-pm8008-regulator
        /drivers/regulator/qcom-rpmh-regulator
        /drivers/remoteproc/qcom_common
        /drivers/remoteproc/qcom_pil_info
        /drivers/remoteproc/qcom_q6v5
        /drivers/remoteproc/qcom_q6v5_pas
        /drivers/remoteproc/qcom_sysmon
        /drivers/rpmsg/qcom_glink
        /drivers/rpmsg/qcom_smd
        /drivers/rpmsg/rpmsg_core
        /drivers/rtc/rtc-pm8xxx
        /drivers/scsi/scsi_common
        /drivers/scsi/sd_mod
        /drivers/slimbus/slimbus
        /drivers/soc/qcom/apr
        /drivers/soc/qcom/icc-bwmon
        /drivers/soc/qcom/llcc-qcom
        /drivers/soc/qcom/mdt_loader
        /drivers/soc/qcom/ocmem
        /drivers/soc/qcom/pdr_interface
        /drivers/soc/qcom/pmic_glink
        /drivers/soc/qcom/qcom_pd_mapper
        /drivers/soc/qcom/qcom_pdr_msg
        /drivers/soc/qcom/qcom_stats
        /drivers/soc/qcom/qmi_helpers
        /drivers/soc/qcom/smem
        /drivers/soc/qcom/smp2p
        /drivers/soc/qcom/socinfo
        /drivers/soundwire/soundwire-bus
        /drivers/soundwire/soundwire-qcom
        /drivers/thermal/qcom/qcom-spmi-adc-tm5
        /drivers/thermal/qcom/qcom-spmi-temp-alarm
        /drivers/thermal/qcom/qcom_tsens
        /drivers/usb/common/ulpi
        /drivers/usb/common/usb-common
        /drivers/usb/core/usbcore
        /drivers/usb/dwc3/dwc3
        /drivers/usb/dwc3/dwc3-qcom-legacy
        /drivers/usb/gadget/udc/udc-core
        /drivers/usb/host/xhci-hcd
        /drivers/usb/host/xhci-plat-hcd
        /drivers/usb/typec/mux/gpio-sbu-mux
        /drivers/usb/typec/typec
        /drivers/usb/typec/ucsi/typec_ucsi
        /drivers/usb/typec/ucsi/ucsi_glink
        /drivers/watchdog/qcom-wdt
        /fs/autofs/autofs4
        /fs/binfmt_misc
        /fs/btrfs/btrfs
        /fs/configfs/configfs
        /fs/efivarfs/efivarfs
        /fs/erofs/erofs
        /fs/fat/fat
        /fs/fat/vfat
        /fs/nls/nls_cp437
        /lib/crc/crc16
        /lib/crypto/gf128mul
        /lib/crypto/libarc4
        /lib/lz4/lz4_compress
        /lib/raid6/raid6_pq
        /lib/reed_solomon/reed_solomon
        /net/qrtr/qrtr-mhi
