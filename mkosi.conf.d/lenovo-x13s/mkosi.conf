[Match]
Architecture=arm64

[Content]
Devicetrees=
    qcom/sc8280xp-lenovo-thinkpad-x13s.dtb
KernelCommandLine=
# tpm is not supported on lenovo-x13s
        rd.systemd.mask=dev-tpm0.device
        systemd.mask=dev-tpm0.service
        rd.systemd.mask=dev-tpmrm0.device
        systemd.mask=dev-tpmrm0.device
        rd.systemd.mask=tpm2.target
        systemd.mask=tpm2.target
# support for this platform is not perfect, disable what we *know* does not work
        arm64.nopauth clk_ignore_unused pd_ignore_unused
Packages=
# firmware for lenovo-x31s
        firmware-qcom-soc
        firmware-atheros
# add basic qualcomm tools
        protection-domain-mapper
        qrtr-tools
# not sure why this is needed
        acpi
# make sound work
        alsa-topology-conf
        alsa-ucm-conf
FirmwareFiles=
        qcom/sc8280xp/LENOVO/21BX/qcadsp8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qccdsp8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qcdxkmsuc8280.mbn
        qcom/sc8280xp/LENOVO/21BX/qcslpi8280.mbn
        qcom/a660_sqe.fw
        qcom/a660_gmu.bin
KernelInitrdModules=
# TODO: limit to needed firmware
        *
# Ensure that modules needed for boot are present
        /drivers/phy/qualcomm/phy-qcom-qmp-pcie
        nvme
# Ensure that modules needed for display output are present
        i2c-core
        i2c-hid
        i2c-hid-of
        i2c-qcom-geni
        leds_qcom_lpg
        pwm_bl
        qrtr
        pmic_glink_altmode
        gpio_sbu_mux
        phy-qcom-qmp-combo
        drm
        drm_kms_helper
        drm_dp_aux_bus
        drm_display_helper
        drm_exec
        gpucc_sc8280xp
        dispcc_sc8280xp
        phy_qcom_edp
        panel-edp
        msm
